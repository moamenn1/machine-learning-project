# System Architecture Overview

## ğŸ—ï¸ Complete Pipeline Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    INPUT: Raw Dataset Images                     â”‚
â”‚                    (1,960 images, 6 classes)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              PHASE 1: Data Augmentation                          â”‚
â”‚              (data_augmentation.py)                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Techniques:                                                     â”‚
â”‚  â€¢ Rotation (Â±20Â°)                                              â”‚
â”‚  â€¢ Horizontal Flip                                              â”‚
â”‚  â€¢ Brightness Adjustment (0.7-1.3x)                             â”‚
â”‚  â€¢ Scaling (0.8-1.2x)                                           â”‚
â”‚  â€¢ Gaussian Noise                                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Output: 3,000 images (500 per class)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              PHASE 2: Deep Learning Feature Extraction           â”‚
â”‚              (feature_extraction.py + img2vec_pytorch)           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Step 1: Preprocessing                                           â”‚
â”‚    â€¢ Convert BGR to RGB (camera compatibility)                  â”‚
â”‚    â€¢ Resize to 224Ã—224 (ResNet-18 input size)                  â”‚
â”‚    â€¢ Minimal preprocessing to preserve features                 â”‚
â”‚                                                                  â”‚
â”‚  Step 2: Transfer Learning with ResNet-18                        â”‚
â”‚    â€¢ Pre-trained on ImageNet (1.2M images)                      â”‚
â”‚    â€¢ Extract features from final layer                          â”‚
â”‚    â€¢ Output: 512-dimensional feature vector                     â”‚
â”‚                                                                  â”‚
â”‚  Benefits over Manual Features:                                  â”‚
â”‚    â€¢ Robust to lighting variations                              â”‚
â”‚    â€¢ Handles different angles/perspectives                      â”‚
â”‚    â€¢ Better generalization to real-world objects                â”‚
â”‚    â€¢ Trained on millions of diverse images                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Output: Feature matrix X (4800 Ã— 512)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              PHASE 3: Feature Scaling                            â”‚
â”‚              (StandardScaler)                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ Z-score normalization: z = (x - Î¼) / Ïƒ                      â”‚
â”‚  â€¢ Fit on training set                                          â”‚
â”‚  â€¢ Transform train and test sets                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              PHASE 4: Train/Test Split                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ Training: 80% (2,400 samples)                                â”‚
â”‚  â€¢ Validation: 20% (600 samples)                                â”‚
â”‚  â€¢ Stratified split (maintains class distribution)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚                            â”‚
             â–¼                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   SVM Classifier       â”‚  â”‚   k-NN Classifier                  â”‚
â”‚   (train_models.py)    â”‚  â”‚   (train_models.py)                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Hyperparameters:       â”‚  â”‚ Hyperparameters:                   â”‚
â”‚ â€¢ Kernel: RBF          â”‚  â”‚ â€¢ k: 5                             â”‚
â”‚ â€¢ C: 10.0              â”‚  â”‚ â€¢ Weights: distance                â”‚
â”‚ â€¢ Gamma: scale         â”‚  â”‚ â€¢ Metric: euclidean                â”‚
â”‚ â€¢ Probability: True    â”‚  â”‚                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Training:              â”‚  â”‚ Training:                          â”‚
â”‚ â€¢ Fit on X_train       â”‚  â”‚ â€¢ Store X_train, y_train           â”‚
â”‚ â€¢ Learn support vectorsâ”‚  â”‚ â€¢ No explicit training             â”‚
â”‚ â€¢ Optimize decision    â”‚  â”‚   (lazy learning)                  â”‚
â”‚   boundaries           â”‚  â”‚                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Prediction:            â”‚  â”‚ Prediction:                        â”‚
â”‚ â€¢ Fast (support        â”‚  â”‚ â€¢ Compute distances to all         â”‚
â”‚   vectors only)        â”‚  â”‚   training samples                 â”‚
â”‚ â€¢ Probability output   â”‚  â”‚ â€¢ Find k nearest neighbors         â”‚
â”‚                        â”‚  â”‚ â€¢ Distance-weighted vote           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Output:                â”‚  â”‚ Output:                            â”‚
â”‚ svm_classifier.pkl     â”‚  â”‚ knn_classifier.pkl                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚                           â”‚
             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              PHASE 5: Model Evaluation                           â”‚
â”‚              (evaluate_model.py, compare_models.py)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Metrics:                                                        â”‚
â”‚  â€¢ Accuracy                                                      â”‚
â”‚  â€¢ Precision, Recall, F1-score (per class)                      â”‚
â”‚  â€¢ Confusion Matrix                                              â”‚
â”‚  â€¢ Prediction Speed                                              â”‚
â”‚  â€¢ Memory Usage                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              PHASE 6: Real-time Deployment                       â”‚
â”‚              (realtime_classifier.py)                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Pipeline:                                                       â”‚
â”‚                                                                  â”‚
â”‚  Camera Frame                                                    â”‚
â”‚      â”‚                                                           â”‚
â”‚      â–¼                                                           â”‚
â”‚  Preprocess (resize, blur)                                       â”‚
â”‚      â”‚                                                           â”‚
â”‚      â–¼                                                           â”‚
â”‚  Extract Features (HOG + Color)                                  â”‚
â”‚      â”‚                                                           â”‚
â”‚      â–¼                                                           â”‚
â”‚  Scale Features (StandardScaler)                                 â”‚
â”‚      â”‚                                                           â”‚
â”‚      â–¼                                                           â”‚
â”‚  Predict (SVM or k-NN)                                          â”‚
â”‚      â”‚                                                           â”‚
â”‚      â–¼                                                           â”‚
â”‚  Rejection Check (confidence < 0.6?)                            â”‚
â”‚      â”‚                                                           â”‚
â”‚      â”œâ”€ Yes â†’ Classify as "unknown"                            â”‚
â”‚      â””â”€ No  â†’ Use predicted class                              â”‚
â”‚      â”‚                                                           â”‚
â”‚      â–¼                                                           â”‚
â”‚  Display Result (class + confidence)                             â”‚
â”‚                                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Features:                                                       â”‚
â”‚  â€¢ Real-time processing (10-30 FPS)                             â”‚
â”‚  â€¢ Confidence visualization                                      â”‚
â”‚  â€¢ Color-coded classes                                          â”‚
â”‚  â€¢ Model switching (press 's')                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“Š Data Flow Diagram

```
Raw Image (HÃ—WÃ—3)
    â”‚
    â”œâ”€â†’ Preprocessing
    â”‚       â”‚
    â”‚       â”œâ”€â†’ Resize to 128Ã—128
    â”‚       â””â”€â†’ Gaussian Blur
    â”‚
    â”œâ”€â†’ HOG Extraction
    â”‚       â”‚
    â”‚       â”œâ”€â†’ Convert to Grayscale
    â”‚       â”œâ”€â†’ Compute Gradients
    â”‚       â”œâ”€â†’ Orientation Binning
    â”‚       â””â”€â†’ Block Normalization
    â”‚       â”‚
    â”‚       â””â”€â†’ HOG Vector (~1,700 dims)
    â”‚
    â”œâ”€â†’ Color Histogram
    â”‚       â”‚
    â”‚       â”œâ”€â†’ For each channel (B, G, R):
    â”‚       â”‚       â”œâ”€â†’ Compute histogram (32 bins)
    â”‚       â”‚       â””â”€â†’ Normalize
    â”‚       â”‚
    â”‚       â””â”€â†’ Color Vector (96 dims)
    â”‚
    â””â”€â†’ Concatenate
            â”‚
            â””â”€â†’ Feature Vector (~1,800 dims)
                    â”‚
                    â”œâ”€â†’ Scale (StandardScaler)
                    â”‚
                    â””â”€â†’ Classify (SVM or k-NN)
                            â”‚
                            â””â”€â†’ Class Label + Confidence
```

## ğŸ”„ Training vs Inference

### Training Mode (train_models.py)

```
Dataset (3,000 images)
    â”‚
    â”œâ”€â†’ Extract features for all images
    â”‚       â”‚
    â”‚       â””â”€â†’ Feature matrix X (3000 Ã— 1800)
    â”‚
    â”œâ”€â†’ Split train/test (80/20)
    â”‚       â”‚
    â”‚       â”œâ”€â†’ X_train (2400 Ã— 1800)
    â”‚       â””â”€â†’ X_test (600 Ã— 1800)
    â”‚
    â”œâ”€â†’ Fit scaler on X_train
    â”‚       â”‚
    â”‚       â””â”€â†’ Save scaler.pkl
    â”‚
    â”œâ”€â†’ Transform X_train and X_test
    â”‚
    â”œâ”€â†’ Train SVM
    â”‚       â”‚
    â”‚       â””â”€â†’ Save svm_classifier.pkl
    â”‚
    â””â”€â†’ Train k-NN
            â”‚
            â””â”€â†’ Save knn_classifier.pkl
```

### Inference Mode (realtime_classifier.py)

```
New Image
    â”‚
    â”œâ”€â†’ Extract features
    â”‚       â”‚
    â”‚       â””â”€â†’ Feature vector (1 Ã— 1800)
    â”‚
    â”œâ”€â†’ Load scaler.pkl
    â”‚       â”‚
    â”‚       â””â”€â†’ Transform features
    â”‚
    â”œâ”€â†’ Load model.pkl (SVM or k-NN)
    â”‚       â”‚
    â”‚       â””â”€â†’ Predict class + confidence
    â”‚
    â””â”€â†’ Apply rejection threshold
            â”‚
            â”œâ”€â†’ confidence < 0.6 â†’ "unknown"
            â””â”€â†’ confidence â‰¥ 0.6 â†’ predicted class
```

## ğŸ¯ Class Distribution

### Before Augmentation
```
Glass     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 401
Paper     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 476
Cardboard â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 259
Plastic   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 386
Metal     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 328
Trash     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 110
```

### After Augmentation
```
Glass     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 500
Paper     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 500
Cardboard â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 500
Plastic   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 500
Metal     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 500
Trash     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 500
```

## ğŸ§  Model Architectures

### SVM Architecture
```
Input Features (1800 dims)
    â”‚
    â”œâ”€â†’ RBF Kernel Transformation
    â”‚       â”‚
    â”‚       â””â”€â†’ K(x, x') = exp(-Î³ ||x - x'||Â²)
    â”‚
    â”œâ”€â†’ Decision Function
    â”‚       â”‚
    â”‚       â””â”€â†’ f(x) = Î£ Î±áµ¢ yáµ¢ K(xáµ¢, x) + b
    â”‚
    â”œâ”€â†’ Multi-class (One-vs-Rest)
    â”‚       â”‚
    â”‚       â”œâ”€â†’ 6 binary classifiers
    â”‚       â””â”€â†’ Softmax for probabilities
    â”‚
    â””â”€â†’ Output
            â”‚
            â”œâ”€â†’ Class (0-5)
            â””â”€â†’ Confidence (0-1)
```

### k-NN Architecture
```
Input Features (1800 dims)
    â”‚
    â”œâ”€â†’ Compute Distances
    â”‚       â”‚
    â”‚       â””â”€â†’ d(x, xáµ¢) = ||x - xáµ¢||â‚‚
    â”‚
    â”œâ”€â†’ Find k=5 Nearest Neighbors
    â”‚       â”‚
    â”‚       â””â”€â†’ Sort by distance
    â”‚
    â”œâ”€â†’ Distance-weighted Voting
    â”‚       â”‚
    â”‚       â””â”€â†’ weight = 1 / distance
    â”‚
    â””â”€â†’ Output
            â”‚
            â”œâ”€â†’ Class (majority vote)
            â””â”€â†’ Confidence (from distances)
```

## ğŸ“ File Dependencies

```
config.py
    â”‚
    â”œâ”€â†’ data_augmentation.py
    â”‚       â”‚
    â”‚       â””â”€â†’ Creates: dataset_augmented/
    â”‚
    â”œâ”€â†’ feature_extraction.py
    â”‚       â”‚
    â”‚       â”œâ”€â†’ Used by: train_models.py
    â”‚       â”œâ”€â†’ Used by: realtime_classifier.py
    â”‚       â””â”€â†’ Used by: evaluate_model.py
    â”‚
    â”œâ”€â†’ train_models.py
    â”‚       â”‚
    â”‚       â”œâ”€â†’ Requires: feature_extraction.py
    â”‚       â””â”€â†’ Creates: models/*.pkl
    â”‚
    â”œâ”€â†’ realtime_classifier.py
    â”‚       â”‚
    â”‚       â”œâ”€â†’ Requires: feature_extraction.py
    â”‚       â””â”€â†’ Requires: models/*.pkl
    â”‚
    â”œâ”€â†’ evaluate_model.py
    â”‚       â”‚
    â”‚       â”œâ”€â†’ Requires: feature_extraction.py
    â”‚       â””â”€â†’ Requires: models/*.pkl
    â”‚
    â””â”€â†’ compare_models.py
            â”‚
            â”œâ”€â†’ Requires: feature_extraction.py
            â””â”€â†’ Requires: models/*.pkl
```

## ğŸš€ Execution Flow

### Option 1: Automated (run_pipeline.py)
```
run_pipeline.py
    â”‚
    â”œâ”€â†’ Step 1: data_augmentation.py
    â”‚       â””â”€â†’ Creates balanced dataset
    â”‚
    â”œâ”€â†’ Step 2: train_models.py
    â”‚       â””â”€â†’ Trains and saves models
    â”‚
    â””â”€â†’ Step 3: realtime_classifier.py
            â””â”€â†’ Launches demo
```

### Option 2: Manual
```
1. python data_augmentation.py
2. python train_models.py
3. python compare_models.py
4. python realtime_classifier.py svm
```

## ğŸ’¾ Saved Artifacts

```
models/
    â”œâ”€â†’ svm_classifier.pkl      (SVM model, ~1-5 MB)
    â”œâ”€â†’ knn_classifier.pkl      (k-NN model, ~10-50 MB)
    â””â”€â†’ feature_scaler.pkl      (StandardScaler, ~100 KB)

dataset_augmented/
    â”œâ”€â†’ glass/      (500 images)
    â”œâ”€â†’ paper/      (500 images)
    â”œâ”€â†’ cardboard/  (500 images)
    â”œâ”€â†’ plastic/    (500 images)
    â”œâ”€â†’ metal/      (500 images)
    â””â”€â†’ trash/      (500 images)
```

## ğŸ¯ Key Design Decisions

| Decision | Rationale |
|----------|-----------|
| HOG + Color features | Combines shape and appearance |
| RBF kernel for SVM | Handles non-linear boundaries |
| k=5 for k-NN | Balances noise sensitivity |
| Distance weighting | Closer neighbors more important |
| 128Ã—128 image size | Balance between detail and speed |
| 0.6 confidence threshold | Balances precision and recall |
| StandardScaler | Essential for distance-based methods |
| 80/20 train/test split | Standard practice |

---

This architecture achieves the project goals while maintaining simplicity and efficiency.
